**------------------------------------------------------------------------------------------------
* @header_start
* WebGrab+Plus ini for grabbing EPG data from TvGuide websites
* @Site: cosmote.gr
* @MinSWversion: V5.0
* @Revision 5 - [16/11/2024] Mat8861
* @Revision 4 - [09/05/2024] Blackbear199
* - url changes
* @Revision 3 - [26/04/2018] Blackbear199
* - showsplit Fix,details elements rewrite
* @Revision 2 - [19/08/2016] ankont
* @Revision 1 - [13/08/2016] ankont
* @Revision 0 - [06/06/2016] Blackbear199
*  - creation
* @Remarks:
* @header_end
**------------------------------------------------------------------------------------------------
site {url=cosmote.gr|timezone=Europe/Athens|maxdays=8|cultureinfo=el-GR|charset=UTF-8|titlematchfactor=90}
site {ratingsystem=GRen|episodesystem=onscreen}
*
url_index {url|https://mwapi-prod.cosmotetvott.gr/api/v3.4/epg/listings/el?from=##start##&to=##end##&callSigns=|channel|&endingIncludedInRange=false}
url_index.headers {customheader=Accept-Encoding=gzip,deflate,br}
*
urldate.format {datestring|dd-MM-yyyy}
global_temp_1.modify{calculate(format=date,yyyy/MM/dd)|'urldate'}
global_temp_2.modify{calculate(format=date,unix)|'global_temp_1'}
global_temp_3.modify{calculate(format=date,unix)|'global_temp_2' 7200 -}
global_temp_4.modify{calculate(format=date,unix)|'global_temp_3' 86399 +}
url_index.modify {replace|##start##|'global_temp_3'}
url_index.modify {replace|##end##|'global_temp_4'}
*
index_urlchannellogo {url||"channels":[{"guid":"|"wide":"|"},|"},}
*
index_showsplit.scrub {multi|"items":[||],"number":|],"number":}
index_showsplit.modify {replace|\}\},\{|\}\}\|\{}
index_showsplit.modify {replace(type=regex)|"\!\?\?\!"|-}
index_showsplit.modify {cleanup(removeduplicates)}
*index_showsplit.modify {(debug)}
*
*index_urlshow.modify {addstart()|https://www.cosmotetv.gr/portal/details/-/closeup/program/'index_temp_1'/'index_title'}
index_urlshow.headers {customheader=Accept-Encoding=gzip,deflate,br}
*
index_start.scrub {single|"startTime":"||Z"|Z"}
index_stop.scrub {single|"endTime":"||Z"|Z"}
index_title.scrub {regex||"type":"[^"]*","title":"([^"]*)","||}
*index_title.scrub {regex||"qoe":{"title":"([^"]*)","||}****ENGLISH
index_category.scrub {single|"genre":"||",|",}
index_description.scrub {single|"description":"||",|",}
index_premiere.scrub {regex||"isPremiere":(true),"||}
index_premiere.modify {addend|(lang=null)}
index_rating.scrub {single|"rating":"||",|",}
index_showicon.scrub{single|"thumbnails":{|"standard":"|"|}}
index_title.modify {remove(type=regex)|"\s*\(.*?\)"}
index_episode.modify {substring(pattern="Κ'S1' Ε'E1'""Κ'S1'""Ε'E1'""K'S1' E'E1'""K'S1'""E'E1'" type=regex)|'index_title' "\s*([ΚK]\d+\s[ΕE]\d+\|[ΚK]\d+\|[ΕE]\d+)"}
index_title.modify {remove('index_episode' not "" type=regex)|"\s*(?:[ΚK]\d+\s[ΕE]\d+\|[ΚK]\d+\|[ΕE]\d+)"}
index_temp_1.scrub{"programGuid":"||",|",}
*
title.scrub {single|</div> <h1>||</h1>|</h1>}
description.scrub {single|<div class="epg-closeup-info-text">||</div>|</div>}
category.scrub {single(separator="<i>" include="Κατηγορία:")|<div class="epg-closeup-small-info"> <i>||</div>|</div>}
director.scrub {single(separator="<i>" include="Σκηνοθεσία:")|<div class="epg-closeup-small-info"> <i>||</div>|</div>}
actor.scrub {single(separator="<i>" include="Ηθοποιοί:")|<div class="epg-closeup-small-info"> <i>||</div>|</div>}
ratingicon.scrub {url|https://www.cosmote.gr|<span class="epg-closeup-main-rating-">|src="|"/>|</span>}
showicon.scrub {url(exclude="noimage")|https://www.cosmote.gr|<div class="epg-closeup-main-image">|src="|"/>|</div>}
*
scope.range {(showdetails)|end}
title.modify {addstart("")|'index_title'}
title.modify {remove| (E)}
title.modify {remove| (Ε)}
title.modify {remove| (Μ)}
title.modify {remove| (M)}
title.modify {remove| (Z)}
title.modify {remove| (Ζ)}
title.modify {remove|(ν)}
title.modify {remove(type=regex)|"\s*(?:[ΚK]\d+\s[ΕE]\d+\|[ΚK]\d+\|[ΕE]\d+)"}
titleoriginal.modify {substring(type=regex)|'title' "\s\((.+?)\)"}
title.modify {remove('titleoriginal' not "")| ('titleoriginal')}
titleoriginal.modify {addend(not "")|(lang=en)}
subtitle.modify {substring('description' not "" type=regex)|'description' "Επεισόδιο:\s*(.*?)\.\s"}
description.modify {remove('subtitle' not "")|Επεισόδιο: 'subtitle'. }
category.modify {remove|Κατηγορία:</i>}
category.modify {cleanup(tags="<"">")}
category.modify {replace|,|\|}
director.modify {remove|Σκηνοθεσία:</i>}
director.modify {cleanup(tags="<"">")}
director.modify {replace|,|\|}
actor.modify {remove|Ηθοποιοί:</i>}
actor.modify {cleanup(tags="<"">")}
actor.modify {replace|,|\|}
description.modify {remove(separator=",")| Σκηνοθεσία: 'director'.}
producer.modify {substring('description' not "" type=regex)|'description' "\sΠαραγωγή:\s(.*?)(?:\.$\|,\s\d{4}\.(?:\s\(\d+.\)\.?)?$)"}
description.modify {remove('producer' not "" type=regex)| Παραγωγή: 'producer'\.?}
commentator.modify {substring('description' not "" type=regex)|'description' "Περιγραφή:\s*(.*?)\.\s*"}
description.modify {remove('commentator' not "" type=regex)|"Περιγραφή:\s*'commentator'\.\s*"}
commentator.modify {replace(not "")|,|\|}
productiondate.modify {substring('description' not "" type=regex)|'description' "\((\d{4})\)\.?"}
description.modify {remove('productiondate' not "" type=regex)|\('productiondate'\)\.?\s*}
temp_1.modify {substring('description' not "" type=regex)|'description' ",\s(\d{4})\.(?:\s\(\d+.\)\.?)?$"}
description.modify {remove('temp_1' not "")|, 'temp_1'.}
productiondate.modify {set('temp_1' not "")|'temp_1'}
rating.modify {substring('ratingicon' not "" type=regex)|'ratingicon' "/ratings/([^\.]*)\.png"}
loop {('rating' not "" max=1)|end}
rating.modify {set("G")|all}
rating.modify {set("PG")|pga}
rating.modify {set("PG-13")|pgc}
rating.modify {set("R")|pg15}
rating.modify {set("NC-17")|x}
end_loop
end_scope
*temp_9.scrub{multi(debug)||||}
**  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _
**      #####  CHANNEL FILE CREATION (only to create the xxx-channel.xml file)
**
** @auto_xml_channel_start
*url_index {url|https://mwapi-prod.cosmotetvott.gr/api/v3.4/epg/listings/el?from=##start##&to=##end##&endingIncludedInRange=false}
*index_site_id.scrub {regex||{"guid":"[^"]*","title":"[^"]*","type":"channel","callSign":"([^"]*)","||}
*index_site_channel.scrub {regex||{"guid":"[^"]*","title":"([^"]*)","type":"channel","callSign":"[^"]*","||}
*scope.range {(channellist)|end}
*index_site_id.modify {cleanup(removeduplicates=equal,100 link="index_site_channel")}
*end_scope
** @auto_xml_channel_end
